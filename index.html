<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador del Sorteo - La Gaceta</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        /* --- Variables CSS --- */
        :root {
            --brand-blue: #004a94;
            --brand-yellow: #fcd34d;
            --text-main: #111827;
            --bg-body: #f3f4f6;
            --whatsapp-green: #25D366;
        }

        /* --- Estilos Base --- */
        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            overflow-x: hidden;
        }

        h1, h2, .brand-font {
            font-family: 'Roboto', serif;
            font-weight: 600;
        }

        /* Scrollbar personalizado */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 4px; }

        /* --- Pantalla de Introducci칩n --- */
        #intro-screen {
            position: fixed;
            inset: 0;
            background: rgba(255,255,255,0.98);
            z-index: 200;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
            transition: opacity 0.5s ease-out;
            overflow-y: auto;
        }
        #intro-screen.hidden-screen {
            opacity: 0;
            pointer-events: none;
        }

        /* --- RESTAURADOS: Estilos de las Bolillas de Grupo --- */
        .draw-ball {
            width: 60px;
            height: 60px;
            background: radial-gradient(circle at 30% 30%, #ffffff, #d1d5db);
            border-radius: 50%;
            box-shadow: inset -2px -2px 5px rgba(0,0,0,0.15), 0 4px 6px rgba(0,0,0,0.2);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            transition: transform 0.2s;
            position: relative;
            border: 1px solid #9ca3af;
            z-index: 10;
            color: #333;
            flex-direction: column;
            line-height: 1;
        }        
        .draw-ball:hover {
            transform: translateY(-5px) scale(1.05);
            border-color: var(--brand-blue);
            box-shadow: 0 10px 15px rgba(0, 74, 148, 0.3);
        }
        /* Animaci칩n para desaparecer cuando el grupo est치 lleno */
        .draw-ball.popped {
            animation: popDisappear 0.3s forwards;
            pointer-events: none;
        }
        .draw-ball-label {
            font-size: 8px;
            font-weight: 700;
            color: #6b7280;
            text-transform: uppercase;
        }
        .draw-ball-group {
            font-size: 18px;
            font-weight: 900;
            color: var(--brand-blue);
        }

        @keyframes popDisappear {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0.5); opacity: 0; }
        }

        /* --- Animaciones de los Slots (Casilleros) --- */
        .slot-filled {
            animation: flashSlot 0.5s;
            background-color: #ffffff; 
        }
        @keyframes flashSlot {
            0% { background-color: var(--brand-yellow); color: black; }
            50% { background-color: var(--brand-blue); color: white; }
            100% { background-color: #ffffff; color: black; }
        }

        /* --- Caja de Instrucciones (Footer del juego) --- */
        .instruction-box-footer {
            background-color: #eff6ff;
            border: 1px solid #bfdbfe;
            color: #1e3a8a;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-family: 'Roboto', sans-serif;
            margin: 0 auto;
            padding: 12px 16px;
            border-radius: 8px;
        }

        /* --- Estilos espec칤ficos para botones de compartir --- */
        .btn-whatsapp {
            background-color: var(--whatsapp-green);
        }
        .btn-whatsapp:hover {
            background-color: #1da851;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col relative">

    <div id="intro-screen" class="py-8">
        <h1 class="text-3xl md:text-5xl font-black text-[#004a94] mb-4 tracking-tight leading-tight max-w-4xl">
            Simul치 el sorteo del Mundial 2026
        </h1>
        <p class="text-lg md:text-xl text-gray-700 mb-8 font-light max-w-2xl">
            Mir치 c칩mo podr칤an quedar armados los grupos de la primera fase con nuestro simulador interactivo.
        </p>

        <button onclick="startGame()" class="bg-[#004a94] text-white text-lg md:text-xl font-bold py-3 px-10 md:py-4 md:px-12 rounded-full hover:bg-[#003870] transition transform hover:scale-105 shadow-xl tracking-widest uppercase border-2 border-blue-800 animate-bounce-slow mb-8">
            Comenzar Sorteo
        </button>

        <div class="bg-blue-50 border border-blue-200 rounded-xl p-5 mb-8 max-w-2xl text-left mx-4 shadow-sm">
            <h3 class="text-[#004a94] font-bold mb-3 text-base md:text-lg uppercase tracking-wider border-b border-blue-200 pb-2">Mec치nica de Sorteo</h3>
            <ul class="space-y-3 text-gray-800 text-sm md:text-[15px] leading-relaxed font-medium">
                <li class="flex gap-2 items-start">
                    <span class="text-blue-500 mt-0.5 text-xl">游녤</span>
                    <span><span class="font-black text-gray-900">Eleg칤 un Grupo:</span> Hac칠 clic en cualquiera de las bolillas de grupo en la barra inferior.</span>
                </li>
                <li class="flex gap-2 items-start">
                    <span class="text-blue-500 mt-0.5 text-xl">游녤</span>
                    <span><span class="font-black text-gray-900">Paso a paso:</span> Segu칤 presionando la misma bolilla para completar los 4 cupos.</span>
                </li>
                <li class="flex gap-2 items-start">
                    <span class="text-blue-500 mt-0.5 text-xl">游녤</span>
                    <span><span class="font-black text-gray-900">Completar:</span> Cuando un grupo se llena, su bolilla desaparecer치. 춰Complet치 los 12 grupos!</span>
                </li>
            </ul>
        </div>
    </div>

    <header class="bg-white border-b border-gray-300 sticky top-0 z-40 shadow-sm h-4"></header>

    <main class="flex-grow container mx-auto p-4 md:p-8">        
        
        <div class="flex flex-col md:flex-row justify-between items-end border-b-2 border-[#004a94] pb-3 mb-6">
            <div>
                <h2 class="text-3xl font-black text-gray-900">SORTEO MUNDIAL 2026</h2>
            </div>
            <div id="status-badge" class="mt-2 md:mt-0 px-4 py-2 bg-white text-[#004a94] text-sm font-bold uppercase tracking-wider rounded shadow-sm border border-gray-300">
                Esperando inicio
            </div>
        </div>

        <div class="w-full flex justify-center my-6 z-10 relative px-4">
            <a href="https://www.sporting.com.ar/" target="_blank" rel="noopener noreferrer" class="block w-full max-w-[728px] mx-auto shadow-sm rounded overflow-hidden hover:opacity-95 transition-opacity">
                <picture>
                    <source media="(min-width: 768px)" srcset="https://img.lagaceta.com.ar/publicidad/SPGBlackFriday-Banner728x90.gif">
                    <img src="https://img.lagaceta.com.ar/publicidad/SPGBlackFriday-Banner320x100.gif" alt="Publicidad Sporting" class="w-full h-auto mx-auto">
                </picture>
            </a>
        </div>
        <div id="groups-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:gap-6">
            </div>

        <div class="h-64"></div> </main>

    <footer class="fixed bottom-0 w-full z-30 bg-white border-t-2 border-gray-300 shadow-[0_-5px_25px_rgba(0,0,0,0.1)] pb-safe">
        <div class="container mx-auto px-4 py-3">
            
         

            <div class="text-center mt-1">
                <h2 id="action-text" class="text-xs font-bold text-gray-500 mb-3 uppercase tracking-widest animate-pulse">Seleccion치 un grupo para empezar</h2>
                
                <div id="balls-container" class="flex flex-wrap justify-center gap-3 min-h-[60px]">
                    </div>
                
                <div id="share-buttons-container" class="hidden mt-5 flex flex-wrap justify-center gap-3 pb-2">
                    <a href="https://wa.me/?text=Ya%20jugu%C3%A9%20al%20Simulador%20del%20Sorteo%20del%20Mundial%202026%20realizado%20por%20LA%20GACETA.%20%C2%BFY%20vos%3F%20Jugalo%20ac%C3%A1%3A%20https%3A%2F%2Fwww.lagaceta.com.ar%2Fsorteo-mundial-2026" target="_blank" rel="noopener noreferrer" class="btn-whatsapp text-white font-bold py-2 px-4 rounded shadow flex items-center gap-2 transition transform hover:scale-105 text-sm uppercase tracking-wider">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M13.601 2.326A7.854 7.854 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.933 7.933 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.898 7.898 0 0 0 13.6 2.326zM7.994 14.521a6.573 6.573 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.557 6.557 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592zm3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.065-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.099-.445-1.076-.612-1.47-.16-.389-.323-.335-.445-.34-.114-.007-.247-.007-.38-.007a.729.729 0 0 0-.529.247c-.182.198-.691.677-.691 1.654 0 .977.71 1.916.81 2.049.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232z"/></svg>
                        Compartir
                    </a>
                    <a href="mailto:?subject=Simulador%20Sorteo%20Mundial%202026&body=Ya%20jugu%C3%A9%20al%20Simulador%20del%20Sorteo%20del%20Mundial%202026%20realizado%20por%20LA%20GACETA.%20%C2%BFY%20vos%3F%0A%0AJugalo%20ac%C3%A1%3A%20https://www.lagaceta.com.ar/sorteo-mundial-2026" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded shadow flex items-center gap-2 transition transform hover:scale-105 text-sm uppercase tracking-wider">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2zm13 2.383-4.708 2.825L15 11.105V5.383zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741zM1 11.105l4.708-2.897L1 5.383v5.722z"/></svg>
                        Enviar
                    </a>
                </div>

                <button id="reset-btn" onclick="resetDraw()" class="hidden mt-4 px-8 py-2 bg-[#004a94] text-white font-bold rounded shadow hover:bg-blue-900 transition uppercase tracking-widest text-sm border border-blue-800">
                    Reiniciar Sorteo
                </button>
            </div>
        </div>
    </footer>

    <script>
        /* --- DATA --- */
        const hostAssignments = [
            { team: { name: "M칠xico", code: "mx", conf: "CONCACAF" }, groupIndex: 0 },
            { team: { name: "Canad치", code: "ca", conf: "CONCACAF" }, groupIndex: 1 },
            { team: { name: "Estados Unidos", code: "us", conf: "CONCACAF" }, groupIndex: 3 }
        ];

        const potsData = [
            { id: 1, teams: [ { name: "Argentina", code: "ar", conf: "CONMEBOL" }, { name: "Brasil", code: "br", conf: "CONMEBOL" }, { name: "Inglaterra", code: "gb-eng", conf: "UEFA" }, { name: "Francia", code: "fr", conf: "UEFA" }, { name: "Espa침a", code: "es", conf: "UEFA" }, { name: "B칠lgica", code: "be", conf: "UEFA" }, { name: "Portugal", code: "pt", conf: "UEFA" }, { name: "Alemania", code: "de", conf: "UEFA" }, { name: "Pa칤ses Bajos", code: "nl", conf: "UEFA" } ] },
            { id: 2, teams: [ { name: "Uruguay", code: "uy", conf: "CONMEBOL" }, { name: "Colombia", code: "co", conf: "CONMEBOL" }, { name: "Croacia", code: "hr", conf: "UEFA" }, { name: "Suiza", code: "ch", conf: "UEFA" }, { name: "Austria", code: "at", conf: "UEFA" }, { name: "Marruecos", code: "ma", conf: "CAF" }, { name: "Senegal", code: "sn", conf: "CAF" }, { name: "Jap칩n", code: "jp", conf: "AFC" }, { name: "Ir치n", code: "ir", conf: "AFC" }, { name: "Corea del Sur", code: "kr", conf: "AFC" }, { name: "Australia", code: "au", conf: "AFC" }, { name: "Ecuador", code: "ec", conf: "CONMEBOL" } ] },
            { id: 3, teams: [ { name: "Paraguay", code: "py", conf: "CONMEBOL" }, { name: "Noruega", code: "no", conf: "UEFA" }, { name: "Escocia", code: "gb-sct", conf: "UEFA" }, { name: "T칰nez", code: "tn", conf: "CAF" }, { name: "Egipto", code: "eg", conf: "CAF" }, { name: "Argelia", code: "dz", conf: "CAF" }, { name: "Ghana", code: "gh", conf: "CAF" }, { name: "Costa de Marfil", code: "ci", conf: "CAF" }, { name: "Cabo Verde", code: "cv", conf: "CAF" }, { name: "Qatar", code: "qa", conf: "AFC" }, { name: "Arabia Saudita", code: "sa", conf: "AFC" }, { name: "Panam치", code: "pa", conf: "CONCACAF" } ] },
            { id: 4, teams: [ { name: "Uzbekist치n", code: "uz", conf: "AFC" }, { name: "Jordania", code: "jo", conf: "AFC" }, { name: "Sud치frica", code: "za", conf: "CAF" }, { name: "Nueva Zelanda", code: "nz", conf: "OFC" }, { name: "Hait칤", code: "ht", conf: "CONCACAF" }, { name: "Curazao", code: "cw", conf: "CONCACAF" }, { name: "Repechaje 1", code: "un", conf: "WLD" }, { name: "Repechaje 2", code: "un", conf: "WLD" }, { name: "Repechaje 3", code: "un", conf: "WLD" }, { name: "Repechaje 4", code: "un", conf: "WLD" }, { name: "Repechaje 5", code: "un", conf: "WLD" }, { name: "Repechaje 6", code: "un", conf: "WLD" } ] }
        ];

        const groupNames = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L"];
        
        // Estado l칩gico global
        let groupsContent = Array(12).fill(null).map(() => Array(4).fill(null));
        // NUEVO ESTADO: Controla cu치ntos equipos se han revelado por grupo
        let groupProgress = Array(12).fill(0); 
        let isAnimating = false;

        document.addEventListener('DOMContentLoaded', () => {
            initUI();
        });

        function startGame() {
            const intro = document.getElementById('intro-screen');
            intro.classList.add('hidden-screen');
            
            preCalculateEntireDraw();
            
            document.getElementById('status-badge').innerText = "EN CURSO";
            document.getElementById('action-text').innerText = "Toc치 un grupo para revelar un equipo";
            // RESTAURADO: Renderizar bolillas
            renderGroupBalls();
        }

        function initUI() {
            const groupsGrid = document.getElementById('groups-grid');
            groupsGrid.innerHTML = '';
            groupNames.forEach((letter, index) => {
                const div = document.createElement('div');
                div.className = "bg-white border border-gray-300 rounded-lg shadow-md overflow-hidden flex flex-col h-full hover:shadow-lg transition-shadow";
                div.innerHTML = `
                    <div class="p-2 bg-[#004a94] flex justify-between items-center border-b border-blue-900">
                        <span class="font-black text-white text-lg tracking-tight brand-font">GRUPO ${letter}</span>
                    </div>
                    <div class="p-3 flex-grow space-y-2 bg-white" id="group-content-${index}">
                        ${[0,1,2,3].map(i => `
                            <div class="group-slot-${i} py-2 px-3 border border-gray-200 rounded flex items-center gap-3 h-11 bg-gray-50 transition-all duration-300">
                                <div class="w-6 h-4 bg-gray-200 rounded-sm flex-shrink-0 border border-gray-300 placeholder-flag"></div>
                                <div class="h-2 w-20 bg-gray-200 rounded-full placeholder-text"></div>
                            </div>
                        `).join('')}
                    </div>
                `;
                groupsGrid.appendChild(div);
            });
        }

        // --- L칍GICA CORE: PRE-C츼LCULO (Igual que antes) ---
        function preCalculateEntireDraw() {
            hostAssignments.forEach(h => {
                groupsContent[h.groupIndex][0] = h.team;
            });
            let remainingPot1 = [...potsData[0].teams].sort(() => Math.random() - 0.5);
            let hostIndices = hostAssignments.map(h => h.groupIndex);
            let pot1Index = 0;
            for (let i = 0; i < 12; i++) {
                if (!hostIndices.includes(i)) {
                    groupsContent[i][0] = remainingPot1[pot1Index++];
                }
            }
            for (let potId = 1; potId < 4; potId++) {
                 fillPotAcrossGroups(potId);
            }
        }

        function fillPotAcrossGroups(potIndex) {
            const teamsToPlace = [...potsData[potIndex].teams];
            let attempts = 0;
            let success = false;
            while (!success && attempts < 10000) {
                let shuffledTeams = [...teamsToPlace].sort(() => Math.random() - 0.5);
                let tempPlacement = Array(12).fill(null);
                let possible = true;
                for (let i = 0; i < 12; i++) {
                    let team = shuffledTeams[i];
                    let currentGroupTeams = groupsContent[i].filter(t => t !== null);
                    if (checkConstraint(team, currentGroupTeams)) {
                        tempPlacement[i] = team;
                    } else {
                        possible = false;
                        break;
                    }
                }
                if (possible) {
                    for(let i=0; i<12; i++) {
                        groupsContent[i][potIndex] = tempPlacement[i];
                    }
                    success = true;
                }
                attempts++;
            }
             if (!success) location.reload();
        }

        function checkConstraint(team, groupTeams) {
            const sameConfedCount = groupTeams.filter(t => t.conf === team.conf).length;
            if (team.conf === 'UEFA') { return sameConfedCount < 2; }
            return sameConfedCount < 1;
        }
        // ---------------------------------------------------------


        // --- RESTAURADO: RENDERIZADO DE BOLILLAS DE GRUPO ---
        function renderGroupBalls() {
            const container = document.getElementById('balls-container');
            container.innerHTML = '';
            groupNames.forEach((name, index) => {
                const b = document.createElement('div');
                b.className = "draw-ball group";
                b.innerHTML = `
                    <span class="draw-ball-label">GRUPO</span>
                    <span class="draw-ball-group">${name}</span>
                `;
                // NUEVO HANDLER: Clic paso a paso
                b.onclick = (e) => handleBallClick(index, e.currentTarget);
                container.appendChild(b);
            });
        }

        // --- NUEVA L칍GICA DE CLIC PASO A PASO ---
        function handleBallClick(groupIndex, ballElement) {
            // Si est치 animando o el grupo ya est치 lleno (progreso >= 4), no hacer nada
            if (isAnimating || groupProgress[groupIndex] >= 4) return;

            isAnimating = true;
            
            // Obtener el slot actual a revelar (0, 1, 2, o 3)
            const currentSlot = groupProgress[groupIndex];
            const team = groupsContent[groupIndex][currentSlot];
            
            // Colocar el equipo en la grilla
            placeInGroupAnimated(team, groupIndex, currentSlot);
            
            // Incrementar progreso
            groupProgress[groupIndex]++;

            // Si se completaron los 4 equipos, desaparecer la bola
            if (groupProgress[groupIndex] === 4) {
                ballElement.classList.add('popped');
                checkFinish();
            }

            // Peque침o delay para evitar clics ultrarr치pidos
            setTimeout(() => { isAnimating = false; }, 300);
        }


        function placeInGroupAnimated(team, groupIdx, potIdx) {
            const container = document.getElementById(`group-content-${groupIdx}`);
            const target = container.children[potIdx]; 

            if(target) {
                const flagUrl = team.code === 'un' ? '' : `https://flagcdn.com/w40/${team.code}.png`;
                const imgTag = flagUrl ? `<img src="${flagUrl}" class="w-6 h-4 object-cover rounded shadow-sm border border-gray-300">` : `<div class="w-6 h-4 bg-gray-400 rounded"></div>`;

                target.innerHTML = `
                    ${imgTag}
                    <span class="font-bold text-sm text-gray-900 truncate">${team.name}</span>
                `;
                target.classList.add("slot-filled", "shadow-sm", "bg-white");
                target.classList.remove("bg-gray-50");
                const placeholderFlag = target.querySelector('.placeholder-flag');
                if(placeholderFlag) placeholderFlag.remove();
                const placeholderText = target.querySelector('.placeholder-text');
                if(placeholderText) placeholderText.remove();
            }
        }

        function checkFinish() {
            // Verificar si los 12 grupos tienen progreso 4
            const allFinished = groupProgress.every(progress => progress === 4);
            if (allFinished) {
                finishDraw();
            }
        }

        function finishDraw() {
            document.getElementById('balls-container').innerHTML = '';
            document.getElementById('action-text').innerHTML = "<span class='text-green-700 text-lg font-black'>춰SORTEO FINALIZADO!</span>";
            document.getElementById('status-badge').innerText = "FINAL";
            document.getElementById('status-badge').className = "px-4 py-1 rounded bg-green-100 text-green-800 text-xs font-bold border border-green-300";
            
            document.getElementById('reset-btn').classList.remove('hidden');
            document.getElementById('share-buttons-container').classList.remove('hidden');

            launchConfetti();
        }

        function resetDraw() {
            location.reload();
        }

        function launchConfetti() {
             const colors = ['#004a94', '#fcd34d', '#ffffff', '#ef4444'];
            for(let i=0; i<100; i++) {
                const c = document.createElement('div');
                c.style.position = 'fixed';
                c.style.left = Math.random() * 100 + 'vw';
                c.style.top = '-10px';
                c.style.width = Math.random() * 10 + 5 + 'px';
                c.style.height = Math.random() * 10 + 5 + 'px';
                c.style.background = colors[Math.floor(Math.random() * colors.length)];
                c.style.zIndex = 999;
                c.style.animation = `fall ${Math.random() * 3 + 2}s linear forwards`;
                document.body.appendChild(c);
            }
            const style = document.createElement('style');
            style.innerHTML = `@keyframes fall { to { transform: translateY(100vh) rotate(720deg); } }`;
            document.head.appendChild(style);
        }
    </script>
</body>
</html>
